(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{151:function(t,a,s){t.exports=s.p+"assets/img/memory05.35e268e9.jpg"},217:function(t,a,s){t.exports=s.p+"assets/img/memory01.711bcd35.jpg"},218:function(t,a,s){t.exports=s.p+"assets/img/memory02.e00fa62c.jpg"},219:function(t,a,s){t.exports=s.p+"assets/img/memory03.0dc280d0.jpg"},220:function(t,a,s){t.exports=s.p+"assets/img/memory06.10f5c9d6.jpg"},221:function(t,a,s){t.exports=s.p+"assets/img/memory07.df775eee.jpg"},222:function(t,a,s){t.exports=s.p+"assets/img/memory08.0a3a9c87.jpg"},327:function(t,a,s){"use strict";s.r(a);var n=s(2),e=Object(n.a)({},function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"内存管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#内存管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 内存管理")]),t._v(" "),n("h2",{attrs:{id:"_1-javascript中的垃圾收集"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-javascript中的垃圾收集","aria-hidden":"true"}},[t._v("#")]),t._v(" 1 JavaScript中的垃圾收集")]),t._v(" "),n("ul",[n("li",[t._v("程序运行时需要内存，只要程序要求，操作系统就必须提供内存")]),t._v(" "),n("li",[t._v('JavaScript使用自动内存管理，这被称为"垃圾回收机制"(garbage collector)')]),t._v(" "),n("li",[t._v("有点是可以简化开发、节省代码")]),t._v(" "),n("li",[t._v("缺点是无法完整的掌握内存的分配与回收的具体过程")])]),t._v(" "),n("h3",{attrs:{id:"_1-1-nodejs中的内存管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-nodejs中的内存管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1 NodeJS中的内存管理")]),t._v(" "),n("ul",[n("li",[t._v("网页端的内存泄露")]),t._v(" "),n("li",[t._v("对于持续运行的服务进程Node服务器端程序，必须及时释放不再用到的内存。否则，内存越来越高，轻则影响系统的性能，重则导致进程崩溃。")]),t._v(" "),n("li",[t._v("如果不再用到的内存没有及时释放，就叫内存泄露")])]),t._v(" "),n("h3",{attrs:{id:"_1-2-v8内存管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-v8内存管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2 V8内存管理")]),t._v(" "),n("h4",{attrs:{id:"_1-2-1-v8内存限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-v8内存限制","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.1 V8内存限制")]),t._v(" "),n("ul",[n("li",[t._v("在64位操作系统可以使用1.4G内存")]),t._v(" "),n("li",[t._v("在32位操作系统可以使用0.7G内存")])]),t._v(" "),n("h4",{attrs:{id:"_1-2-2-v8内存管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-v8内存管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.2 V8内存管理")]),t._v(" "),n("ul",[n("li",[t._v("JS对象都是通过V8进行分配管理内存的")]),t._v(" "),n("li",[n("code",[t._v("process.memoryUsage")]),t._v("返回一个对象，包含了Node进程的内存占用信息")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoryUsage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n\t{\n    rss: 21221376,\n    heapTotal: 7708672,\n    heapUsed: 4270272,\n    external: 8224 \n  }\n*/")]),t._v("\n")])])]),n("ul",[n("li",[t._v("rss(resident set size)：所有内存占用，包括指令区和堆栈。栈：存放本地变量、指针。HeapTotal(堆)： 存放对象，闭包。")]),t._v(" "),n("li",[t._v('heapTotal: "堆"占用的内存，包括用到的和没用到的')]),t._v(" "),n("li",[t._v("heapUsed: 用到的堆的部分。判断内存泄露，以"),n("code",[t._v("heapUsed")]),t._v("字段为准")]),t._v(" "),n("li",[t._v("external: V8引擎内部的C++对象占用的内存")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(217),alt:""}})]),t._v(" "),n("p",[n("img",{attrs:{src:s(218),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"_1-2-3-为何限制内存大小"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-为何限制内存大小","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.3 为何限制内存大小")]),t._v(" "),n("ul",[n("li",[t._v("因为V8的垃圾工作原理导致的，1.4G内存完成一次垃圾收集需要1s以上")]),t._v(" "),n("li",[t._v("这个暂停时间成为 Stop The World，在这个期间，应用的性能和响应能力都会下降。")])]),t._v(" "),n("h4",{attrs:{id:"_1-2-4-如何打开内存限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4-如何打开内存限制","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2.4 如何打开内存限制")]),t._v(" "),n("ul",[n("li",[t._v("一旦初始化成功，生效后不能再修改")]),t._v(" "),n("li",[t._v("-max-new-space-size，最大 new space大小，执行 scanvenge 回收，默认 16M，单位KB")]),t._v(" "),n("li",[t._v("-max-old-space-size，最大old space大小，执行 MarkSweep 回收，默认 1G，单位MB")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("node --max-new-space-size=1024 app.js\t# 单位是KB\nnode --max-old-space-size=2000 app.js # 单位是M\n")])])]),n("h2",{attrs:{id:"_2-v8的垃圾回收机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-v8的垃圾回收机制","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. V8的垃圾回收机制")]),t._v(" "),n("ul",[n("li",[t._v("V8是基于分代的垃圾回收")]),t._v(" "),n("li",[t._v("不同代垃圾回收机制也不一样")]),t._v(" "),n("li",[t._v("按存活时间分为新生代和老生代")])]),t._v(" "),n("h3",{attrs:{id:"_2-1-分代"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-分代","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.1 分代")]),t._v(" "),n("ul",[n("li",[t._v("年龄小的是新生代，由From区域和To区域两个区域组成\n"),n("ul",[n("li",[t._v("在64位系统里，新生代内存是32M，From区域和To区域各占用16M")]),t._v(" "),n("li",[t._v("在32位系统里，新生代内存是16M，From区域和To区域各占用8M")])])]),t._v(" "),n("li",[t._v("年龄大的是老生代，默认情况下\n"),n("ul",[n("li",[t._v("64位系统下老生代内存是1400M")]),t._v(" "),n("li",[t._v("32位系统下老生代内存是700M")])])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(219),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_2-2-新生代垃圾回收"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-新生代垃圾回收","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.2 新生代垃圾回收")]),t._v(" "),n("ul",[n("li",[t._v("新生代区域一分为二，每个16M，一个使用，一个空闲")]),t._v(" "),n("li",[t._v("开始垃圾回收，会检查FROM区域中的存活对象，如果还活着，拷贝到TO空间，完成后释放空间")]),t._v(" "),n("li",[t._v("完成后FROM和TO互换")]),t._v(" "),n("li",[t._v("新生代扫描的时候是一种广度优先的扫描策略")]),t._v(" "),n("li",[t._v("新生代的空间小，存活对象少")]),t._v(" "),n("li",[t._v("当一个对象经过多次的垃圾回收依然存活的时候，生存周期比较长的对象会被移动到老生代，这个移动过程被称为晋升或者升级。\n"),n("ul",[n("li",[t._v("经过5次以上的回收还存在")]),t._v(" "),n("li",[t._v("TO的空间使用占比超过25%，或者超大对象")])])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(220),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_2-3-引用计数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-引用计数","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.3 引用计数")]),t._v(" "),n("ul",[n("li",[t._v("语言引擎有一张引用表，保存了内存里所有的资源的引用次数。")]),t._v(" "),n("li",[t._v("如果一个值的引用次数是0，就表示这个值不再用到了，因此可以将这块内存释放。")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(151),alt:""}})]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" objB "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" objC "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" objF "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nglobal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("objA "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  objB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  objC\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"_2-3-1-一个实际的例子"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-一个实际的例子","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.3.1 一个实际的例子")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token doctype"}},[t._v("<!DOCTYPE html>")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("viewport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width=device-width, initial-scale=1.0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("X-UA-Compatible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ie=edge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Document"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Person")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" p1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'weisuoke1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" p2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'weisuoke2'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 销毁内存")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     p1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n ")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:s(151),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_2-4-老生代"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-老生代","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.4 老生代")]),t._v(" "),n("ul",[n("li",[t._v("mark-sweep(标记清除) mark-compact(标记整理)")]),t._v(" "),n("li",[t._v("老生代空间大，大部分都是活着的对象，GC耗时比较长")]),t._v(" "),n("li",[t._v("在GC期间无法响应，STOP-THE-WORLD")]),t._v(" "),n("li",[t._v("V8有一个优化方案，增量处理，把一个大暂停换成多个小暂停INCREMENT-GC")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(221),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"_2-4-1-mark-sweep-标记清除"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-1-mark-sweep-标记清除","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.4.1 mark-sweep(标记清除)")]),t._v(" "),n("ul",[n("li",[t._v("标记活着的对象，随后清除在标记阶段没有标记的对象，只清理死亡对象")]),t._v(" "),n("li",[t._v("问题在于清除后会出现内存不连续的情况，这种内存碎片会对后续的内存分配产生影响")]),t._v(" "),n("li",[t._v("如果要分配一个大对象，碎片空间无法分配")])]),t._v(" "),n("h4",{attrs:{id:"_2-4-2-mark-compact-标记整理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-2-mark-compact-标记整理","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.4.2 mark-compact(标记整理)")]),t._v(" "),n("ul",[n("li",[t._v("标记死亡后会对对象进行整理，活着的对象向左移动，移动完成后直接清理掉边界外的内存。")])]),t._v(" "),n("h4",{attrs:{id:"_2-4-3-inuremental-marking-增量标记"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-3-inuremental-marking-增量标记","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.4.3 inuremental marking 增量标记")]),t._v(" "),n("ul",[n("li",[t._v("以上三种回收时都需要暂停程序执行，收集完成后才能恢复，"),n("em",[t._v("STOP-THE-WORLD")]),t._v("在新生代影响不大，但是老生代影响就非常大。")]),t._v(" "),n("li",[t._v("增量标记就是把标记改为了增量标记，把一口气的停顿拆分成了多个小步骤，做完一步程序运行一会儿，垃圾回收和应用程序运行交替进行，停顿时间可以减少1/6左右")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(222),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"_3-参考阅读"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-参考阅读","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 参考阅读")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://segmentfault.com/a/1190000017392370",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript如何工作:内存管理+如何处理4个常见的内存泄漏"),n("OutboundLink")],1)])])])},[],!1,null,null,null);a.default=e.exports}}]);